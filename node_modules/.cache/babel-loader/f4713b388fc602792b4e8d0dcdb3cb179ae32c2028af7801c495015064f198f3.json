{"ast":null,"code":"import axios from'axios';// Centralized Axios instance with JWT and error handling\nconst api=axios.create({baseURL:process.env.REACT_APP_API_URL?process.env.REACT_APP_API_URL+'/api':'http://localhost:5000/api',withCredentials:true// for refresh token cookie\n});// Attach JWT from localStorage if present\napi.interceptors.request.use(config=>{const token=localStorage.getItem('token');if(token){config.headers['Authorization']=\"Bearer \".concat(token);}return config;});// Centralized error handler\nexport function handleApiError(error){if(error.response&&error.response.data&&error.response.data.message){return error.response.data.message;}if(error.message)return error.message;return'An error occurred.';}// --- FAVORITES ---\nconst favoritesCache={list:null};export async function getFavorites(){let force=arguments.length>0&&arguments[0]!==undefined?arguments[0]:false;if(favoritesCache.list&&!force)return favoritesCache.list;try{const{data}=await api.get('/favorites');favoritesCache.list=data;return data;}catch(error){throw handleApiError(error);}}export async function addFavorite(movie){try{const{data}=await api.post('/favorites',movie);favoritesCache.list=null;// Invalidate cache\nreturn data;}catch(error){throw handleApiError(error);}}export async function removeFavorite(movieId){try{const{data}=await api.delete(\"/favorites/\".concat(movieId));favoritesCache.list=null;return data;}catch(error){throw handleApiError(error);}}// --- WATCHLISTS ---\nconst watchlistsCache={list:null};export async function getWatchlists(){let force=arguments.length>0&&arguments[0]!==undefined?arguments[0]:false;if(watchlistsCache.list&&!force)return watchlistsCache.list;try{const{data}=await api.get('/watchlists');watchlistsCache.list=data;return data;}catch(error){throw handleApiError(error);}}export async function createWatchlist(watchlist){try{const{data}=await api.post('/watchlists',watchlist);watchlistsCache.list=null;return data;}catch(error){throw handleApiError(error);}}export async function addMovieToWatchlist(watchlistId,movie){try{const{data}=await api.post(\"/watchlists/\".concat(watchlistId,\"/movies\"),movie);watchlistsCache.list=null;return data;}catch(error){throw handleApiError(error);}}export async function removeMovieFromWatchlist(watchlistId,movieId){try{const{data}=await api.delete(\"/watchlists/\".concat(watchlistId,\"/movies/\").concat(movieId));watchlistsCache.list=null;return data;}catch(error){throw handleApiError(error);}}// --- REVIEWS ---\nexport async function getUserReviews(userId){try{const{data}=await api.get(\"/reviews/user/\".concat(userId));return data;}catch(error){throw handleApiError(error);}}export async function addReview(review){try{const{data}=await api.post('/reviews',review);return data;}catch(error){throw handleApiError(error);}}export async function updateReview(id,review){try{const{data}=await api.put(\"/reviews/\".concat(id),review);return data;}catch(error){throw handleApiError(error);}}export async function deleteReview(id){try{const{data}=await api.delete(\"/reviews/\".concat(id));return data;}catch(error){throw handleApiError(error);}}// --- MOVIES ---\nexport async function searchMovies(params){try{const{data}=await api.get('/movies/search',{params});return data;}catch(error){throw handleApiError(error);}}","map":{"version":3,"names":["axios","api","create","baseURL","process","env","REACT_APP_API_URL","withCredentials","interceptors","request","use","config","token","localStorage","getItem","headers","concat","handleApiError","error","response","data","message","favoritesCache","list","getFavorites","force","arguments","length","undefined","get","addFavorite","movie","post","removeFavorite","movieId","delete","watchlistsCache","getWatchlists","createWatchlist","watchlist","addMovieToWatchlist","watchlistId","removeMovieFromWatchlist","getUserReviews","userId","addReview","review","updateReview","id","put","deleteReview","searchMovies","params"],"sources":["C:/Users/Bitrus.ed/Desktop/movie-recommendation-app/frontend/src/api.js"],"sourcesContent":["import axios from 'axios';\r\n\r\n// Centralized Axios instance with JWT and error handling\r\nconst api = axios.create({\r\n  baseURL: process.env.REACT_APP_API_URL\r\n    ? process.env.REACT_APP_API_URL + '/api'\r\n    : 'http://localhost:5000/api',\r\n  withCredentials: true, // for refresh token cookie\r\n});\r\n\r\n// Attach JWT from localStorage if present\r\napi.interceptors.request.use((config) => {\r\n  const token = localStorage.getItem('token');\r\n  if (token) {\r\n    config.headers['Authorization'] = `Bearer ${token}`;\r\n  }\r\n  return config;\r\n});\r\n\r\n// Centralized error handler\r\nexport function handleApiError(error) {\r\n  if (error.response && error.response.data && error.response.data.message) {\r\n    return error.response.data.message;\r\n  }\r\n  if (error.message) return error.message;\r\n  return 'An error occurred.';\r\n}\r\n\r\n// --- FAVORITES ---\r\nconst favoritesCache = { list: null };\r\nexport async function getFavorites(force = false) {\r\n  if (favoritesCache.list && !force) return favoritesCache.list;\r\n  try {\r\n    const { data } = await api.get('/favorites');\r\n    favoritesCache.list = data;\r\n    return data;\r\n  } catch (error) {\r\n    throw handleApiError(error);\r\n  }\r\n}\r\nexport async function addFavorite(movie) {\r\n  try {\r\n    const { data } = await api.post('/favorites', movie);\r\n    favoritesCache.list = null; // Invalidate cache\r\n    return data;\r\n  } catch (error) {\r\n    throw handleApiError(error);\r\n  }\r\n}\r\nexport async function removeFavorite(movieId) {\r\n  try {\r\n    const { data } = await api.delete(`/favorites/${movieId}`);\r\n    favoritesCache.list = null;\r\n    return data;\r\n  } catch (error) {\r\n    throw handleApiError(error);\r\n  }\r\n}\r\n\r\n// --- WATCHLISTS ---\r\nconst watchlistsCache = { list: null };\r\nexport async function getWatchlists(force = false) {\r\n  if (watchlistsCache.list && !force) return watchlistsCache.list;\r\n  try {\r\n    const { data } = await api.get('/watchlists');\r\n    watchlistsCache.list = data;\r\n    return data;\r\n  } catch (error) {\r\n    throw handleApiError(error);\r\n  }\r\n}\r\nexport async function createWatchlist(watchlist) {\r\n  try {\r\n    const { data } = await api.post('/watchlists', watchlist);\r\n    watchlistsCache.list = null;\r\n    return data;\r\n  } catch (error) {\r\n    throw handleApiError(error);\r\n  }\r\n}\r\nexport async function addMovieToWatchlist(watchlistId, movie) {\r\n  try {\r\n    const { data } = await api.post(`/watchlists/${watchlistId}/movies`, movie);\r\n    watchlistsCache.list = null;\r\n    return data;\r\n  } catch (error) {\r\n    throw handleApiError(error);\r\n  }\r\n}\r\nexport async function removeMovieFromWatchlist(watchlistId, movieId) {\r\n  try {\r\n    const { data } = await api.delete(`/watchlists/${watchlistId}/movies/${movieId}`);\r\n    watchlistsCache.list = null;\r\n    return data;\r\n  } catch (error) {\r\n    throw handleApiError(error);\r\n  }\r\n}\r\n\r\n// --- REVIEWS ---\r\nexport async function getUserReviews(userId) {\r\n  try {\r\n    const { data } = await api.get(`/reviews/user/${userId}`);\r\n    return data;\r\n  } catch (error) {\r\n    throw handleApiError(error);\r\n  }\r\n}\r\nexport async function addReview(review) {\r\n  try {\r\n    const { data } = await api.post('/reviews', review);\r\n    return data;\r\n  } catch (error) {\r\n    throw handleApiError(error);\r\n  }\r\n}\r\nexport async function updateReview(id, review) {\r\n  try {\r\n    const { data } = await api.put(`/reviews/${id}`, review);\r\n    return data;\r\n  } catch (error) {\r\n    throw handleApiError(error);\r\n  }\r\n}\r\nexport async function deleteReview(id) {\r\n  try {\r\n    const { data } = await api.delete(`/reviews/${id}`);\r\n    return data;\r\n  } catch (error) {\r\n    throw handleApiError(error);\r\n  }\r\n}\r\n\r\n// --- MOVIES ---\r\nexport async function searchMovies(params) {\r\n  try {\r\n    const { data } = await api.get('/movies/search', { params });\r\n    return data;\r\n  } catch (error) {\r\n    throw handleApiError(error);\r\n  }\r\n}"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}